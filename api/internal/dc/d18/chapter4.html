<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<title>CasADi: Integrators</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="CasADi"/>
<link href="../../customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="http://casadi.org"><img src="/api/html/casadi.png" alt="CasADi" height="55px"/></a>&#160;<span>internal API<sup style="font-size:30%">(<a href="../../../html/index.html">switch to public</a>)</sup></span> - <a href="https://github.com/casadi/casadi/tree/a2d71bf95dbd3fa5f6725504bcba67dd52869d91" id="a2d71bf95dbd3fa5f6725504bcba67dd52869d91" >revision 3.6.7</a></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Integrators </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table style="width: 100%;">
<tr>
<td style="text-align: left;">Previous chapter: <a class="el" href="../../dd/d81/chapter3.html">Symbolic core</a> </td><td style="text-align: right;">Next chapter: <a class="el" href="../../d4/d8d/chapter5.html">Code generation</a>  </td></tr>
</table>
<p><b>Contents</b> </p><ol>
<li>
<a class="el" href="../../dc/d18/chapter4.html#section4_1">Integration of explicit ODEs</a> <ul>
<li>
<a class="el" href="../../dc/d18/chapter4.html#subsection4_1_1">Evaluation of forward and backward sensitivities</a> </li>
<li>
<p class="startli"><a class="el" href="../../dc/d18/chapter4.html#subsection4_1_2">Getting intermediate values</a></p>
<p class="endli"></p>
</li>
</ul>
</li>
<li>
<a class="el" href="../../dc/d18/chapter4.html#section4_2">Integration of implicit ODEs</a> </li>
</ol>
<p>In this chapter we will discuss a special family of functions: integrators. We would like to solve explicit and implicit Ordinary Differential Equations (ODE), quadrature formulas together with sensitivities. CasADi comes with well established interface to state-of-the-art ODE solvers like CVODES and IDAS from the Sundials suite.</p>
<h1><a class="anchor" id="section4_1"></a>
Integration of explicit ODEs</h1>
<p>In this section we will study how to use integrators and calculate sensitivites. Most of the things are already known from previous sections since integrators transparently behave like functions. We are concerned with the following explicit ODE. </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align} \noindent\dot{x} &amp;= f(x(t), p)\\ \dot{y} &amp;= g(x(t), p)\\ x(0) &amp;= x_0 \end{align}" src="../../form_23.png" width="260" height="51"/>
</p>
<p> In the following piece of code we show how easy it is to solve ODEs with quadratures. </p><table border="0" style="border-style: dotted; border-width: 1px;">
<tr>
<td>Example:</td><td>Output: </td></tr>
<tr style="vertical-align: top;">
<td><div class="fragment"><div class="line"> 1  <a class="code" href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">SX</a> t(<span class="stringliteral">&quot;t&quot;</span>); <a class="code" href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">SX</a> u(<span class="stringliteral">&quot;u&quot;</span>); <a class="code" href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">SX</a> s(<span class="stringliteral">&quot;s&quot;</span>); <a class="code" href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">SX</a> v(<span class="stringliteral">&quot;v&quot;</span>); <a class="code" href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">SX</a> m(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"> 2  vector&lt;SX&gt; ode(3);</div>
<div class="line"> 3  ode[0] = v;</div>
<div class="line"> 4  ode[1] = (u - 0.02 * v * v) / m;</div>
<div class="line"> 5  ode[2] = -0.01 * u * u;</div>
<div class="line"> 6  vector&lt;SX&gt; quad(2);</div>
<div class="line"> 7  quad[0] = s;</div>
<div class="line"> 8  quad[1] = 0.45 * m * v * v;</div>
<div class="line"> 9  vector&lt;vector&lt;SX&gt; &gt; ode_vars(DAE_NUM_IN);</div>
<div class="line">10  ode_vars[DAE_T].push_back(t);</div>
<div class="line">11  ode_vars[DAE_Y].push_back(s); ode_vars[DAE_Y].push_back(v); ode_vars[DAE_Y].push_back(m);</div>
<div class="line">12  ode_vars[DAE_P].push_back(u);</div>
<div class="line">13  SXFunction ode_func(ode_vars, ode);</div>
<div class="line">14  SXFunction quad_func(ode_vars, quad);</div>
<div class="line">15  CVodesIntegrator <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>(ode_func, quad_func);</div>
<div class="line">16  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setOption(<span class="stringliteral">&quot;t0&quot;</span>, 0.0);</div>
<div class="line">17  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setOption(<span class="stringliteral">&quot;tf&quot;</span>, 1.0);</div>
<div class="line">18  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.init();</div>
<div class="line">19  vector&lt;double&gt; x0(3 + 2);</div>
<div class="line">20  fill(x0.begin(), x0.end(), 0.0);</div>
<div class="line">21  x0[0] = 0; x0[1] = 1; x0[2] = 10;</div>
<div class="line">22  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setInput(x0, INTEGRATOR_X0);</div>
<div class="line">23  vector&lt;double&gt; p(1);</div>
<div class="line">24  p[0] = 0.15;</div>
<div class="line">25  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setInput(p, INTEGRATOR_P);</div>
<div class="line">26  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.evaluate();</div>
<div class="line">27  vector&lt;double&gt; xf = <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.output(INTEGRATOR_XF);</div>
<div class="line">28  cout &lt;&lt; <span class="stringliteral">&quot;Solution of ODE: (&quot;</span>;</div>
<div class="line">29     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; 3; ++j){</div>
<div class="line">30        cout &lt;&lt; xf[j] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line">31     }</div>
<div class="line">32     cout &lt;&lt; <span class="stringliteral">&quot;\b)\n&quot;</span>;</div>
<div class="line">33  cout &lt;&lt; <span class="stringliteral">&quot;Solution of quadrature: (&quot;</span>;</div>
<div class="line">34     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 3; j &lt; 5; ++j){</div>
<div class="line">35        cout &lt;&lt; xf[j] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line">36     }</div>
<div class="line">37     cout &lt;&lt; <span class="stringliteral">&quot;\b)\n&quot;</span>;</div>
<div class="ttc" id="agroup__integrator_html_gaccd72bafcfc6609f5e6058f9349abaff"><div class="ttname"><a href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">casadi::integrator</a></div><div class="ttdeci">Function integrator(const std::string &amp;name, const std::string &amp;solver, const SXDict &amp;dae, const Dict &amp;opts)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d01/integrator_8cpp_source.html#l00109">integrator.cpp:109</a></div></div>
<div class="ttc" id="anamespacecasadi_html_a77ea10c3c8f78d7a80e15b83af5b7a82"><div class="ttname"><a href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">casadi::SX</a></div><div class="ttdeci">Matrix&lt; SXElem &gt; SX</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d46/sx__fwd_8hpp_source.html#l00036">sx_fwd.hpp:32</a></div></div>
</div><!-- fragment -->  </td><td><div class="fragment"><div class="line">Solution of ODE: (1.00649,1.01297,9.99978)</div>
<div class="line">Solution of quadrature: (0.50229,4.55863)</div>
</div><!-- fragment -->   </td></tr>
</table>
<p>First of all we introduce a time variable (<code>t</code>), a control parameter (<code>u</code> ) and three dynamic variables(<code>s, v, m</code>). Their data type do not differ, but their use will give them different meaning. We build up our ODE equations (line 2-5) and quadrature formula (line 6-8). Then we collect all our variables in a vector of vectors. In case of integrators one must respect the following rules regarding the function variables. The element addressed by DAE_T is a vector containing only the time variable (line 10). The element addressed by DAE_Y is always the vector of all dynamic variables (line 11). The element, which is addressed by DAE_P, contains the parameters (now we have only one control variable, line 12). Afterwards, we have to define two functions corresponding to our ODE (line 13) and quadrature equations (line 14). Now everything is ready to instantiate the casadi::Sundials::CVodesIntegrator class, which is an interface to the CVODES algorithm. If we have no quadratures then we simply pass only the ODE equations (line 15). If we don't set any options a BDF method is used to carry out integration. After instantiation, we set the initial time and the final time (line 16-17) of the integration. For a detailed description of the available options consult <code>casadi::Sundials::CVodesIntegrator</code> class. .</p>
<p>The initial value of the dynamic variables must be set by the use of <code>INTERGRATOR_X0</code> enum type in the <code>casadi::Sundials::CVodesIntegrator::setInput(...)</code> function. Note that CVODES handles quadratures by introducing dummy dynamic variables and thus the initial value must have length of 3 + 2 = 5 in our example (line 19-22). The parameters (in our case <code>u</code>) should also be assigned a value, this may be done using the <code>INTEGRATOR_P</code> enum type (line 25). After evaluation we can access the solution of the ODE and quadratures by the casadi::Sundials::CVodesIntegrator::output(...) method saying that we would like the value of the dynamic variables at the final time <code>INTEGRATOR_XF</code> (see line 27).</p>
<h2><a class="anchor" id="subsection4_1_1"></a>
Evaluation of forward and backward sensitivities</h2>
<p>As CVodesIntegrator is actually a special function, it is natural to expect first-order derivatives from it. Of course the underlying CVODES integrator must provide sensitivities with respect to the initial value and the parameters used in the equations. We extend our previous source code and explain only the relevant parts.</p>
<table border="0" style="border-style: dotted; border-width: 1px;">
<tr>
<td>Example: </td></tr>
<tr style="vertical-align: top;">
<td><div class="fragment"><div class="line"> 1  CVodesIntegrator <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>(ode_func, quad_func);</div>
<div class="line"> 2  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setOption(<span class="stringliteral">&quot;number_of_fwd_dir&quot;</span>, 1);</div>
<div class="line"> 3  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setOption(<span class="stringliteral">&quot;number_of_adj_dir&quot;</span>, 1);</div>
<div class="line"> 4  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setOption(<span class="stringliteral">&quot;t0&quot;</span>, 0.0);</div>
<div class="line"> 5  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setOption(<span class="stringliteral">&quot;tf&quot;</span>, 2.4);</div>
<div class="line"> 6  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.init();</div>
<div class="line"> 7  vector&lt;double&gt; x0(3 + 2);</div>
<div class="line"> 8  fill(x0.begin(), x0.end(), 0.0);</div>
<div class="line"> 9  x0[0] = 0; x0[1] = 1; x0[2] = 10;</div>
<div class="line">10  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setInput(x0, INTEGRATOR_X0);</div>
<div class="line">11  vector&lt;double&gt; p(1);</div>
<div class="line">12  p[0] = 0.15;</div>
<div class="line">13  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setInput(p, INTEGRATOR_P);</div>
<div class="line">14  vector&lt;double&gt; fwd_seed_x(3 + 2);</div>
<div class="line">15  fill(fwd_seed_x.begin(), fwd_seed_x.end(), 1);</div>
<div class="line">16  vector&lt;double&gt; fwd_seed_p(1);</div>
<div class="line">17  fwd_seed_p[0] = 10;</div>
<div class="line">18  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setFwdSeed(fwd_seed_x, INTEGRATOR_X0);</div>
<div class="line">19  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setFwdSeed(fwd_seed_p, INTEGRATOR_P);</div>
<div class="line">20  vector&lt;double&gt; adj_seed(3 + 2);</div>
<div class="line">21  fill(adj_seed.begin(), adj_seed.end(), 4.0);</div>
<div class="line">22  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setAdjSeed(adj_seed, INTEGRATOR_XF);</div>
<div class="line">23  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.evaluate(1, 1);</div>
<div class="line">24  vector&lt;double&gt; xf = <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.output(INTEGRATOR_XF);</div>
<div class="line">25  vector&lt;double&gt; forward_derivative = <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.fwdSens(INTEGRATOR_XF).data();</div>
<div class="line">26  vector&lt;double&gt; adjoint_derivative_x = <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.adjSens(INTEGRATOR_X0).data();</div>
<div class="line">27  vector&lt;double&gt; adjoint_derivative_p = <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.adjSens(INTEGRATOR_P).data();</div>
</div><!-- fragment -->  </td><td>Output: <div class="fragment"><div class="line">Forward derivative: (6.25543,3.37566,0.928,8.57645,50.2412)</div>
<div class="line">Adjoint derivative_x: (13.6,112.312,8.27986,4,4)</div>
<div class="line">Adjoint derivative_p: (13.5293)</div>
</div><!-- fragment -->   </td></tr>
</table>
<p>Similary as we did in case of plain functions, we have to set the number of directional derivatives (line 2-3). In forward mode more than one direction is supported. The forward seed we have to set with respect to the dynamic variables and the parameters as well (see line 18-19). The way that the adjoint seed must be set comes from the behaviour of CVODES, namely that it does not give possibility to calculate adjoint derivatives, but the feature of integrating backwards. Thus, the adjoint seed is an "initial value" at the final time and should be indexed with <code>INTEGRATOR_XF</code> (see line 22). Gathering the derivatives is just the other way around. Forward derivatives can be collected at the final time (line 25), while adjoints are available at the initial time in two pieces corresponding to dynamic variables and parameters.</p>
<h2><a class="anchor" id="subsection4_1_2"></a>
Getting intermediate values</h2>
<p>It is often the case that the end-value of the ODE is not sufficient, but the the whole trajectory of the states is of interest (e.g. simulation). </p><table border="0" style="border-style: dotted; border-width: 1px;">
<tr>
<td>Example:</td><td>Output: </td></tr>
<tr style="vertical-align: top;">
<td><div class="fragment"><div class="line"> 1  <a class="code" href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">SX</a> t(<span class="stringliteral">&quot;t&quot;</span>);</div>
<div class="line"> 2  <a class="code" href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">SX</a> u(<span class="stringliteral">&quot;u&quot;</span>);</div>
<div class="line"> 3  <a class="code" href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">SX</a> s(<span class="stringliteral">&quot;s&quot;</span>);</div>
<div class="line"> 4  <a class="code" href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">SX</a> v(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"> 5  <a class="code" href="../../d7/d23/namespacecasadi.html#a77ea10c3c8f78d7a80e15b83af5b7a82">SX</a> m(<span class="stringliteral">&quot;m&quot;</span>);</div>
<div class="line"> 6  vector&lt;SX&gt; ode(3);</div>
<div class="line"> 7  ode[0] = v;</div>
<div class="line"> 8  ode[1] = (u - 0.02 * v * v) / m;</div>
<div class="line"> 9  ode[2] = -0.01 * u * u;</div>
<div class="line">10  vector&lt;SX&gt; quad(2);</div>
<div class="line">11  quad[0] = s;</div>
<div class="line">12  quad[1] = 0.45 * m * v * v;</div>
<div class="line">13  vector&lt;vector&lt;SX&gt; &gt; ode_vars(DAE_NUM_IN);</div>
<div class="line">14  ode_vars[DAE_T].push_back(t);</div>
<div class="line">15  ode_vars[DAE_Y].push_back(s); ode_vars[DAE_Y].push_back(v); ode_vars[DAE_Y].push_back(m);</div>
<div class="line">16  ode_vars[DAE_P].push_back(u);</div>
<div class="line">17  SXFunction ode_func(ode_vars, ode);</div>
<div class="line">18  SXFunction quad_func(ode_vars, quad);</div>
<div class="line">19  CVodesIntegrator <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>(ode_func, quad_func);</div>
<div class="line">20  <span class="keywordtype">double</span> t0 = 0.0;</div>
<div class="line">21  <span class="keywordtype">double</span> tf = 1.0;</div>
<div class="line">22  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setOption(<span class="stringliteral">&quot;t0&quot;</span>, t0);</div>
<div class="line">23  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setOption(<span class="stringliteral">&quot;tf&quot;</span>, tf);</div>
<div class="line">24  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.init();</div>
<div class="line">25  vector&lt;double&gt; x0(3 + 2);</div>
<div class="line">26  fill(x0.begin(), x0.end(), 0.0);</div>
<div class="line">27  x0[0] = 0; x0[1] = 1; x0[2] = 10;</div>
<div class="line">28  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setInput(x0, INTEGRATOR_X0);</div>
<div class="line">29  vector&lt;double&gt; p(1);</div>
<div class="line">30  p[0] = 0.15;</div>
<div class="line">31  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.setInput(p, INTEGRATOR_P);</div>
<div class="line">32  <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.reset();</div>
<div class="line">33  <span class="keywordtype">int</span> n_points = 10;</div>
<div class="line">34  <span class="keywordtype">double</span> act_t;</div>
<div class="line">35  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt;= n_points; ++i){</div>
<div class="line">36     act_t = t0 + i * (tf - t0) / n_points;</div>
<div class="line">37     <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.integrate(act_t);</div>
<div class="line">38     cout &lt;&lt; <span class="stringliteral">&quot;Intermediate value at t=&quot;</span> &lt;&lt;</div>
<div class="line">39        act_t &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; <a class="code" href="../../dd/d1b/group__integrator.html#gaccd72bafcfc6609f5e6058f9349abaff">integrator</a>.output(INTEGRATOR_XF) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">40  }</div>
</div><!-- fragment -->  </td><td><div class="fragment"><div class="line">Intermediate value at t=0.1 is [0.100065,1.0013,9.99998,0.00500364,0.450585]</div>
<div class="line">Intermediate value at t=0.2 is [0.20026,1.0026,9.99995,0.0200261,0.90234]</div>
<div class="line">Intermediate value at t=0.3 is [0.300585,1.0039,9.99993,0.0450802,1.35527]</div>
<div class="line">Intermediate value at t=0.4 is [0.401039,1.0052,9.99991,0.0801727,1.80937]</div>
<div class="line">Intermediate value at t=0.5 is [0.501624,1.00649,9.99989,0.12532,2.26464]</div>
<div class="line">Intermediate value at t=0.6 is [0.602338,1.00779,9.99987,0.180532,2.72108]</div>
<div class="line">Intermediate value at t=0.7 is [0.703182,1.00909,9.99984,0.245829,3.17871]</div>
<div class="line">Intermediate value at t=0.8 is [0.804155,1.01038,9.99982,0.32121,3.63751]</div>
<div class="line">Intermediate value at t=0.9 is [0.905258,1.01168,9.9998,0.40669,4.09748]</div>
<div class="line">Intermediate value at t=1 is [1.00649,1.01297,9.99978,0.502289,4.55863]</div>
</div><!-- fragment -->  </td></tr>
</table>
<p>Until line 31 just the usual routines are invoked to set the integrator up, while on line 32 we reset set the time to <em>t0</em> and reset the solvers. Inside the for loop (line 35-39), the integrate(...) method is used to get the actual value of the states at the given time.</p>
<h1><a class="anchor" id="section4_2"></a>
Integration of implicit ODEs</h1>
<table style="width: 100%;">
<tr>
<td style="text-align: left;">Previous chapter: <a class="el" href="../../dd/d81/chapter3.html">Symbolic core</a> </td><td style="text-align: right;">Next chapter: <a class="el" href="../../d4/d8d/chapter5.html">Code generation</a>  </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</body>
</html>
